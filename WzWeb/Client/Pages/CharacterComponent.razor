@page "/character"
@using WzWeb.Shared
@using Microsoft.AspNetCore.WebUtilities
@using Newtonsoft.Json
@using WzWeb.Client.Services
@using WzWeb.Shared.Character
@inject IBrowserService BrowserService

@if (character == null)
{
    <Loading></Loading>
}
else
{
    foreach (var motion in character.CurrentHeadMotion.Actions)
    {
        foreach (var config in motion.Value.Configs)
        {
            var pngInfo = config.Value.PngInfo;
            <img src="data:image/png;base64,@(pngInfo.Base64Data)" class="card-img" alt="..." style="width:@(pngInfo.Width+"px");height:@(pngInfo.Height+"px")" />
        }
    }

    foreach (var motion in character.CurrentBodyMotion.Actions)
    {
        foreach (var config in motion.Value.Configs)
        {
            var pngInfo = config.Value.PngInfo;
            if (pngInfo != null)
            {
                <img src="data:image/png;base64,@(pngInfo.Base64Data)" class="card-img" alt="..." style="width:@(pngInfo.Width + "px");height:@(pngInfo.Height + "px")" />
            }
        }
    }
}


@code {
    private Character character;

    protected async override Task OnInitializedAsync()
    {
        character = await BrowserService.GetCharacter(2000, "walk1", 0);
    }
}
